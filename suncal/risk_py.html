<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Suncal - Measurement Decision Risk</title>
  <link rel="stylesheet" href="style/risk.css" />
  <link rel="stylesheet" href="https://pyscript.net/releases/2024.3.2/core.css">
  <script type="module" src="https://pyscript.net/releases/2024.3.2/core.js"></script>
  <script type="module">
    const loading = document.getElementById('loading');
    addEventListener('py:ready', () => loading.close());
    loading.showModal();
  </script>
</head>

<body>
  <dialog id="loading">
    <h2>Loading...</h2>
  </dialog>
  <div class="container">
    <h1>Suncal Web - Decision Risk Calculator</h1>
  </div>

  <div class="risk-grid" style="margin-top: 2em; margin-bottom: 2em;">
    <div class="risk-grid-child">
      <table>
        <tr>
          <td>
            <input type="checkbox" id="LowLimitEnable" py-change="update_limit_enable" checked>
            <label for="LowLimitEnable" id="LowLLabel">Lower Specification Limit:&nbsp</label>
          </td>
          <td><input type="number" py-change="calculate" value="-1" step="0.1" id="LowL" name="LowL"
              style="border: 1px solid;"></td>
        </tr>
        <tr>
          <td>
            <input type="checkbox" id="UpLimitEnable" py-change="update_limit_enable" checked>
            <label for="UpLimitEnable" id="UpLLabel">Upper Specification Limit:&nbsp</label>
          </td>
          <td><input type="number" py-change="calculate" value="1" step="0.1" id="UpL" name="UpL"
              style="border: 1px solid;"></td>
        </tr>
      </table>

      <div id="processDistribution" style="margin-top: 2em;">
        <label for="processDist">Process Distribution:</label><br>
        <table id="processTable">
          <tr>
            <th>Parameter</th>
            <th>Value</th>
          </tr>
          <tr>
            <td class="select">Distribution</td>
            <td ALIGN="center">
              <div class="dropdown">
                <button class="dropbtn" id="procdist" style="width: 188px">normal</button>
                <div class="dropdown-content" style="width: 188px">
                  <a href="#" id="normalProc" py-click="update_process_rows">normal</a>
                  <a href="#" id="triangularProc" py-click="update_process_rows">triangular</a>
                  <a href="#" id="uniformProc" py-click="update_process_rows">uniform</a>
                  <a href="#" id="gammaProc" py-click="update_process_rows">gamma</a>
                </div>
              </div>
            </td>
          </tr>
          <tr>
            <td><label for="Median" id="MedianLabel">Median</label></td>
            <td><input type="number" py-change="calculate" value="0.0" step="0.1" id="Median" name="Median"> <br></td>
          </tr>
          <tr>
            <td><label for="std" id="stdLabel">std</label></td>
            <td><input type="number" py-change="calculate" value="0.51" step="0.1" id="std" name="std"> <br></td>
          </tr>
          <tr id="procBetaRow" class="input-hidden">
            <td><label for="beta" id="betaLabel">beta</label></td>
            <td><input type="number" py-change="calculate" value="1.0" step="0.1" id="beta" name="beta"> <br> </td>
          </tr>
        </table>
      </div>

      <div id="Test Measurement" style="margin-top: 2em;">
        <label for="testMeasure">Test Measurement:</label><br>
        <table id="testTable">
          <tr>
            <th>Parameter</th>
            <th>Value</th>
          </tr>
          <tr>
            <td class="select">Distribution</td>
            <td ALIGN="center">
              <div class="dropdown">
                <button class="dropbtn" id="measdist" style="width: 188px">normal</button>
                <div class="dropdown-content" style="width: 188px">
                  <a href="#" id="normalMeas" py-click="update_measure_rows">normal</a>
                  <a href="#" id="triangularMeas" py-click="update_measure_rows">triangular</a>
                  <a href="#" id="uniformMeas" py-click="update_measure_rows">uniform</a>
                  <a href="#" id="gammaMeas" py-click="update_measure_rows">gamma</a>
                </div>
              </div>
            </td>
          </tr>
          <tr>
            <td>Measurement</td>
            <td><input type="number" py-change="calculate" min="-20" max="20" value="0.0" step="0.1" id="measurement"
                style="width: 188px;"></td>
          </tr>
          <tr>
            <td><label for="bias" id="biasLabel">Bias</label></td>
            <td><input type="number" py-change="calculate" value="0.0" step="0.1" id="bias" name="bias"> <br></td>
          </tr>
          <tr>
            <td><label for="std2" id="std2Label">std</label></td>
            <td><input type="number" py-change="calculate" value="0.125" step="0.1" id="std2" name="std2"> <br></td>
          </tr>
          <tr id="measBetaRow" class="input-hidden">
            <td><label for="beta2" id="betaLabel2">beta</label></td>
            <td><input type="number" py-change="calculate" value="1.0" step="0.1" id="beta2" name="beta2"> <br> </td>
          </tr>
        </table>
      </div>

      <div style="margin-top: 1.5em;">
        <input type="checkbox" id="conditional" py-change="calculate">
        <label for="conditional">Conditional PFA</label>
      </div>

      <div id="Guardband" style="margin-top: 2em;">
        <input type="checkbox" id="guardband" name="guardband" py-change="enable_guardband">
        <label for="guardband">Guardband:</label><br>
        <table>
          <tr>
            <td><label for="lowerGuard" id="lowerGuardLabel">Lower Guardband (Relative):&nbsp</label></td>
            <td><input type="text" py-change="calculate" value="0" step="0.1" id="lowerGuard" name="lowerGuard" disabled
                style="border: 1px solid;"></td>
          </tr>
          <tr>
            <td><label for="upperGuard" id="upperGuardLabel">Upper Guardband (Relative):&nbsp</label></td>
            <td><input type="text" py-change="calculate" value="0" step="0.1" id="upperGuard" name="upperGuard" disabled
                style="border: 1px solid;"></td>
          </tr>
        </table>
      </div>

      <div id="GuardbandCalc" style="margin-top: 2em;">
        <p>Guardbanding Methods</p>
        <details>
          <summary>PFA-target</summary>
          <input type="number" value="0.8" min="0" max="100" step="0.01" id="TargetPFA" name="TargetPFA"
            style="border: 1px solid; width: 188px;">
          <button class="gbbutton" id="pfa" py-click="calc_guardband">Calculate</button>
        </details>
        <details>
          <summary>PFR-target</summary>
          <input type="number" value="2" min="0" max="100" step="0.01" id="TargetPFR" name="TargetPFR"
            style="border: 1px solid; width: 188px;">
          <button class="gbbutton" id="pfr" py-click="calc_guardband">Calculate</button>
        </details>
        <details>
          <summary>TUR-based</summary>
          <button class="gbbutton" id="dobbert" py-click="calc_guardband">Managed 2% ("Method 6")</button><br>
          <button class="gbbutton" id="rss" py-click="calc_guardband">Root-difference-of-squares</button>
          <button class="gbbutton" id="rp10" py-click="calc_guardband">NCSLI RP-10</button>
          <button class="gbbutton" id="test" py-click="calc_guardband">95% Test Uncertainty</button>
        </details>
        <details>
          <summary>Worst-Case Specific Risk</summary>
          <input type="number" value="5" min="0" max="100" step="0.01" id="worstspecific" name="worstspecific"
            style="border: 1px solid; width: 188px;">
          <button class="gbbutton" id="specific" py-click="calc_guardband">Calculate</button>

        </details>
      </div>
    </div>

    <div class="risk-grid-child">
      <div id="plot">
        <p>Initializing...</p>
      </div>
      <div id="output" style="padding-top: 1em;">
      </div>
    </div>
  </div>

  <br><br>
  <div class="footer" style="padding-top: 3em;">
    <p><a href="index.html">Suncal-Web Home</a></p>
  </div>
  <script type="py" src="src/risk.py" config='{"packages": ["src/whl/suncal-1.6.6-py3-none-any.whl"]}'></script>
</body>

</html>