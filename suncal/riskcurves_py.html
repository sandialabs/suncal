<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Suncal - Risk Curves</title>
    <link rel="stylesheet" href="style/risk.css" />
    <link rel="stylesheet" href="https://pyscript.net/releases/2024.3.2/core.css">
    <script type="module" src="https://pyscript.net/releases/2024.3.2/core.js"></script>
    <script type="module">
        const loading = document.getElementById('loading');
        addEventListener('py:ready', () => loading.close());
        loading.showModal();
    </script>
</head>

<body>
    <dialog id="loading">
        <h2>Loading...</h2>
    </dialog>
    <div class="container">
        <h1>Suncal Web - Decision Risk Curves</h1>
    </div>
    <div class="risk-grid">
        <div class="risk-grid-child">
            <table id="SweepSetUp" style="margin-top: 2em;">
                <tr>
                    <td ALIGN="center">
                        <div class="dropdown">
                            <button class="dropbtn" id="sweepMode">In-tol probability %</button>
                            <div class="dropdown-content">
                                <a href="#" id="intolPercent"
                                    onclick="document.getElementById('sweepMode').textContent='In-tol probability %';">In-tol
                                    probablility %</a>
                                <a href="#" id="SL/Proc"
                                    onclick="document.getElementById('sweepMode').textContent='SL/Process Std. Dev.';">SL/Process
                                    Std. Dev.</a>
                            </div>
                        </div>
                    </td>
                    <td ALIGN="center">
                        <div class="dropdown">
                            <button class="dropbtn" id="variableSelect1">Sweep (x) variable</button>
                            <div class="dropdown-content">
                                <a href="#" id="sweepx"
                                    onclick="document.getElementById('variableSelect1').textContent='Sweep (x) variable'; dropDownBoxChanges1();">Sweep
                                    (x) variable</a>
                                <a href="#" id="stepz"
                                    onclick="document.getElementById('variableSelect1').textContent='Step (z) variable';dropDownBoxChanges1();">Step
                                    (z) variable</a>
                                <a href="#" id="constant"
                                    onclick="document.getElementById('variableSelect1').textContent='Constant'; enableConstant1();">Constant</a>
                            </div>
                        </div>
                    </td>
                    <td><input type="number" min="0" value="90" step="0.01" id="var1Constant" name="var1Constant"
                            disabled> <br> </td>
                </tr>
                <tr>
                    <td><label for="TUR" id="TURLabel">Test Uncertainty Ratio</label></td>
                    <td ALIGN="center">
                        <div class="dropdown">
                            <button class="dropbtn" id="variableSelect2">Step (z) variable</button>
                            <div class="dropdown-content">
                                <a href="#" id="sweepx"
                                    onclick="document.getElementById('variableSelect2').textContent='Sweep (x) variable'; dropDownBoxChanges2();">Sweep
                                    (x) variable</a>
                                <a href="#" id="stepz"
                                    onclick="document.getElementById('variableSelect2').textContent='Step (z) variable'; dropDownBoxChanges2();">Step
                                    (z) variable</a>
                                <a href="#" id="constant"
                                    onclick="document.getElementById('variableSelect2').textContent='Constant'; enableConstant2();">Constant</a>
                            </div>
                        </div>
                    </td>
                    <td><input type="number" min="0" step="0.01" value="4" id="var2Constant" name="var2Constant"
                            disabled> <br> </td>
                </tr>
                <tr>
                    <td><label for="GBF" id="GBFLabel">Guardband Factor</label></td>
                    <td ALIGN="center">
                        <div class="dropdown">
                            <button class="dropbtn" id="variableSelect3">Constant</button>
                            <div class="dropdown-content">
                                <a href="#" id="sweepx"
                                    onclick="document.getElementById('variableSelect3').textContent='Sweep (x) variable'; dropDownBoxChanges3();">Sweep
                                    (x) variable</a>
                                <a href="#" id="stepz"
                                    onclick="document.getElementById('variableSelect3').textContent='Step (z) variable'; dropDownBoxChanges3();">Step
                                    (z) variable</a>
                                <a href="#" id="constant"
                                    onclick="document.getElementById('variableSelect3').textContent='Constant'; enableConstant3();">Constant</a>
                                <a href="#" id="RSS"
                                    onclick="document.getElementById('variableSelect3').textContent='RSS'; dropDownBoxChanges3();">RSS</a>
                                <a href="#" id="Dobbert"
                                    onclick="document.getElementById('variableSelect3').textContent='Dobbert'; dropDownBoxChanges3();">Dobbert</a>
                                <a href="#" id="RP10"
                                    onclick="document.getElementById('variableSelect3').textContent='RP10'; dropDownBoxChanges3();">RP10</a>
                                <a href="#" id="Test95"
                                    onclick="document.getElementById('variableSelect3').textContent='95% Test'; dropDownBoxChanges3();">95%
                                    Test</a>
                            </div>
                        </div>
                    </td>
                    <td><input type="number" min="0" value="1" step="0.01" id="var3Constant" name="var3Constant">
                        <br>
                    </td>
                </tr>

                <tr>
                    <td><label for="ProcBias" id="ProcBiasLabel">Process Bias %</label></td>
                    <td ALIGN="center">
                        <div class="dropdown">
                            <button class="dropbtn" id="variableSelect4">Constant</button>
                            <div class="dropdown-content">
                                <a href="#" id="sweepx"
                                    onclick="document.getElementById('variableSelect4').textContent='Sweep (x) variable'; dropDownBoxChanges4();">Sweep
                                    (x) variable</a>
                                <a href="#" id="stepz"
                                    onclick="document.getElementById('variableSelect4').textContent='Step (z) variable'; dropDownBoxChanges4();">Step
                                    (z) variable</a>
                                <a href="#" id="constant"
                                    onclick="document.getElementById('variableSelect4').textContent='Constant'; enableConstant4();">Constant</a>
                            </div>
                        </div>
                    </td>
                    <td><input type="number" min="0" value="0" step="0.01" id="var4Constant" name="var4Constant">
                        <br>
                    </td>
                </tr>
                <tr>
                    <td><label for="MeasureBias" id="MeasureBiasLabel">Measurement Bias %</label></td>
                    <td ALIGN="center">
                        <div class="dropdown">
                            <button class="dropbtn" id="variableSelect5">Constant</button>
                            <div class="dropdown-content">
                                <a href="#" id="sweepx"
                                    onclick="document.getElementById('variableSelect5').textContent='Sweep (x) variable'; dropDownBoxChanges5();">Sweep
                                    (x) variable</a>
                                <a href="#" id="stepz"
                                    onclick="document.getElementById('variableSelect5').textContent='Step (z) variable'; dropDownBoxChanges5();">Step
                                    (z) variable</a>
                                <a href="#" id="constant"
                                    onclick="document.getElementById('variableSelect5').textContent='Constant'; enableConstant5();">Constant</a>
                            </div>
                        </div>
                    </td>
                    <td><input type="number" min="0" value="0" step="0.01" id="var5Constant" name="var5Constant">
                        <br>
                    </td>
                </tr>
            </table>
            <br><br>

            <div>
                <table id="SweepSetUp2" style="margin-top: 2em;">
                    <tr>
                        <td><label for="sweepXStart" id="sweepXStartLabel">Sweep (x) Start:</label></td>
                        <td><input type="number" value="50" step="1" id="sweepXStart" name="sweepXStart"><br></td>
                    </tr>
                    <tr>
                        <td><label for="sweepXStop" id="sweepXStopLabel">Sweep (x) Stop:</label></td>
                        <td><input type="number" value="90" step="1" id="sweepXStop" name="sweepXStop"><br></td>
                    </tr>
                    <tr>
                        <td><label for="numPoints" id="numPointsLabel"># Points (x):</label></td>
                        <td><input type="number" value="20" step="1" id="numPoints" name="numPoints"><br></td>
                    </tr>
                    <tr>
                        <td><label for="stepZ" id="stepZLabel">Step Values (z):</label></td>
                        <td><input type="text" value="1.5, 2, 3, 4" id="stepZ" name="stepZ"><br></td>
                    </tr>
                </table>
                <br><br>
            </div>

            <div>
                <table id="PlotSweep" style="margin-top: 2em;">
                    <tr>
                        <td><label for="plotType" id="plotTypeLabel">Plot</label></td>
                        <td ALIGN="center">
                            <div class="dropdown">
                                <button class="dropbtn" id="plotSelect">PFA</button>
                                <div class="dropdown-content">
                                    <a href="#" id="PFA"
                                        onclick="document.getElementById('plotSelect').textContent='PFA'">PFA</a>
                                    <a href="#" id="PFR"
                                        onclick="document.getElementById('plotSelect').textContent='PFR'">PFR</a>
                                    <a href="#" id="Both"
                                        onclick="document.getElementById('plotSelect').textContent='Both'">Both</a>
                                </div>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td></td>
                        <td><input type="checkbox" id="plot3D" name="plot3D">
                            <label for="plot3D">3DPlot</label><br>
                        </td>
                    </tr>
                    <tr>
                        <td></td>
                        <td><input type="checkbox" id="LogScale" name="LogScale">
                            <label for="LogScale">Log Scale</label><br>
                        </td>
                    </tr>
                    <tr>
                        <td></td>
                        <td><button class="dropbtn" id="Plot" py-click="calculate_sweep">Plot</button></td>
                    </tr>
                </table>
            </div>
        </div>
        <div class="risk-grid-child" id="output">Initializing...</div>
    </div>
    <div class="footer" style="padding-top: 3em;">
        <p><a href="index.html">Suncal-Web Home</a></p>
    </div>
    <script>
        /* Javascript to change dropdown selections */
        function dropDownBoxChanges1() {
            let var1 = document.getElementById('variableSelect1').textContent;
            let var2 = document.getElementById('variableSelect2').textContent;
            let var3 = document.getElementById('variableSelect3').textContent;
            let var4 = document.getElementById('variableSelect4').textContent;
            let var5 = document.getElementById('variableSelect5').textContent;
            document.getElementById("var1Constant").disabled = true;

            if (var1 === var2) {
                document.getElementById('variableSelect2').textContent = 'Constant';
                document.getElementById("var2Constant").disabled = false;
            }
            else if (var1 === var3) {
                document.getElementById('variableSelect3').textContent = 'Constant';
                document.getElementById("var3Constant").disabled = false;
            }
            else if (var1 === var4) {
                document.getElementById('variableSelect4').textContent = 'Constant';
                document.getElementById("var4Constant").disabled = false;
            }
            else if (var1 === var5) {
                document.getElementById('variableSelect5').textContent = 'Constant';
                document.getElementById("var5Constant").disabled = false;
            }
        }

        function dropDownBoxChanges2() {
            let var1 = document.getElementById('variableSelect1').textContent;
            let var2 = document.getElementById('variableSelect2').textContent;
            let var3 = document.getElementById('variableSelect3').textContent;
            let var4 = document.getElementById('variableSelect4').textContent;
            let var5 = document.getElementById('variableSelect5').textContent;
            document.getElementById("var2Constant").disabled = true;
            if (var2 === var1) {
                document.getElementById('variableSelect1').textContent = 'Constant';
                document.getElementById("var1Constant").disabled = false;
            }
            else if (var2 === var3) {
                document.getElementById('variableSelect3').textContent = 'Constant';
                document.getElementById("var3Constant").disabled = false;
            }
            else if (var2 === var4) {
                document.getElementById('variableSelect4').textContent = 'Constant';
                document.getElementById("var4Constant").disabled = false;
            }
            else if (var2 === var5) {
                document.getElementById('variableSelect5').textContent = 'Constant';
                document.getElementById("var5Constant").disabled = false;
            }
        }

        function dropDownBoxChanges3() {
            let var1 = document.getElementById('variableSelect1').textContent;
            let var2 = document.getElementById('variableSelect2').textContent;
            let var3 = document.getElementById('variableSelect3').textContent;
            let var4 = document.getElementById('variableSelect4').textContent;
            let var5 = document.getElementById('variableSelect5').textContent;
            document.getElementById("var3Constant").disabled = true;
            if (var3 === var1) {
                document.getElementById('variableSelect1').textContent = 'Constant';
                document.getElementById("var1Constant").disabled = false;
            }
            else if (var3 === var2) {
                document.getElementById('variableSelect2').textContent = 'Constant';
                document.getElementById("var2Constant").disabled = false;
            }
            else if (var3 === var4) {
                document.getElementById('variableSelect4').textContent = 'Constant';
                document.getElementById("var4Constant").disabled = false;
            }
            else if (var3 === var5) {
                document.getElementById('variableSelect5').textContent = 'Constant';
                document.getElementById("var5Constant").disabled = false;
            }
        }

        function dropDownBoxChanges4() {
            let var1 = document.getElementById('variableSelect1').textContent;
            let var2 = document.getElementById('variableSelect2').textContent;
            let var3 = document.getElementById('variableSelect3').textContent;
            let var4 = document.getElementById('variableSelect4').textContent;
            let var5 = document.getElementById('variableSelect5').textContent;
            document.getElementById("var4Constant").disabled = true;
            if (var4 === var1) {
                document.getElementById('variableSelect1').textContent = 'Constant';
                document.getElementById("var1Constant").disabled = false;
            }
            else if (var4 === var2) {
                document.getElementById('variableSelect2').textContent = 'Constant';
                document.getElementById("var2Constant").disabled = false;
            }
            else if (var4 === var3) {
                document.getElementById('variableSelect3').textContent = 'Constant';
                document.getElementById("var3Constant").disabled = false;
            }
            else if (var4 === var5) {
                document.getElementById('variableSelect5').textContent = 'Constant';
                document.getElementById("var5Constant").disabled = false;
            }
        }

        function dropDownBoxChanges5() {
            let var1 = document.getElementById('variableSelect1').textContent;
            let var2 = document.getElementById('variableSelect2').textContent;
            let var3 = document.getElementById('variableSelect3').textContent;
            let var4 = document.getElementById('variableSelect4').textContent;
            let var5 = document.getElementById('variableSelect5').textContent;
            document.getElementById("var5Constant").disabled = true;
            if (var5 === var1) {
                document.getElementById('variableSelect1').textContent = 'Constant';
                document.getElementById("var1Constant").disabled = false;
            }
            else if (var5 === var2) {
                document.getElementById('variableSelect2').textContent = 'Constant';
                document.getElementById("var2Constant").disabled = false;
            }
            else if (var5 === var3) {
                document.getElementById('variableSelect3').textContent = 'Constant';
                document.getElementById("var3Constant").disabled = false;
            }
            else if (var5 === var4) {
                document.getElementById('variableSelect4').textContent = 'Constant';
                document.getElementById("var4Constant").disabled = false;
            }
        }

        function enableConstant1() {
            document.getElementById("var1Constant").disabled = false;
        }

        function enableConstant2() {
            document.getElementById("var2Constant").disabled = false;
        }

        function enableConstant3() {
            document.getElementById("var3Constant").disabled = false;
        }

        function enableConstant4() {
            document.getElementById("var4Constant").disabled = false;
        }

        function enableConstant5() {
            document.getElementById("var5Constant").disabled = false;
        }

        function createObject(object, variableName) {
            let execString = variableName + "=object";
            eval(execString);
        }
        function changeCursor() {
            document.body.style.cursor = "wait";
        }
    </script>

    <script type="py" src="src/riskcurves.py" config='{"packages": ["src/whl/suncal-1.6.6-py3-none-any.whl"]}'></script>
</body>

</html>